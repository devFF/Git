Индекс в Git — это специальная промежуточная область, в которой хранятся изменения файлов на пути от рабочей директории до репозитория. При выполнении коммита в него попадают только те изменения, которые были добавлены в индекс. В этом уроке вы узнаете, зачем нужен индекс и как он работает.
Понятие индекса в Git появилось неслучайно. Даже когда разработчик работает над одной задачей, по пути он натыкается на разные проблемы в коде:
- Ошибки
- Код с плохим оформлением
- Фрагменты, которые нужно будет исправить под новые требования
В большинстве ситуаций совершенно нормально исправлять эти недочеты, что все и делают. В итоге в рабочей директории появляется множество разных исправлений. Частично они относятся к выполняемой задаче, а частично — содержат множественные исправления, напрямую не связанные с основными изменениями. В чем здесь проблема?

Представим, что мы сделали ровно один коммит, в который включили и основную задачу, и дополнительные исправления. В таком случае, мы получаем несколько неприятных побочных эффектов.

Во-первых, становится сложнее смотреть историю. Коммит начинает содержать совершенно несвязанные изменения, которые отвлекают во время проверки чужого кода:
```bash
# Обычно в таких коммитах встречается условие И в описании
# Это показатель того, что в рамках одного коммита сделано несколько изменений
git commit -m 'add new feature and fix something'
```

Во-вторых, откат коммита по любым причинам приведет к тому, что откатятся правки, которые все равно нужно будет делать.

Именно здесь помогает **индекс**. Если он есть, мы можем не переживать, как сформируется коммит.

Стандартный способ работы с индексом — это добавление или изменение файлов и последующий коммит:
```bash
git add somefile
git commit -m 'add somefile'
```

Если речь идет про один-два файла, которые нужно закоммитить прямо сейчас, то можно сделать проще. Этот подход работает только с уже отслеживаемыми файлами:
```bash
echo 'new data' >> INFO.md
# Не нужно явно вызывать команду `git add`
git commit INFO.md -m 'update INFO.md'
```

Иногда бывает наоборот — мы исправили много файлов и хотим добавить их в коммит сразу все. Тогда поможет точка:
```bash
# Добавляет абсолютно все изменения рабочей директории в индекс
git add 
```

## Коммит с одновременным добавлением всего в индекс
```bash
# Флаг -a автоматически добавляет все изменения рабочей директории в индекс
git commit -am 'do something'
```

С другой стороны, нередко разные изменения делаются в одних и тех же файлах. То есть изменения в этих файлах по-хорошему должны находиться в разных коммитах.

И даже такое можно сделать с помощью Git. Для этого подходит команда ```git add -i```, которая показывает измененные куски файлов и спрашивает, что с ними сделать.